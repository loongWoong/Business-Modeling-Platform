一、项目定位  
构建一套“本体驱动的业务建模平台”，以 react+python 为技术栈（react实现前端、python提供演示数据后端接口），提供：  
- 三层页面结构（业务域地图 → 域功能模块 → 模型详情模块）  
- 全节点“悬停抽屉”替代原有单击/双击，避免事件冲突  
- 所有模块均具备完整 CRUD+导入/导出+卡片展示  
- 抽屉不遮挡后续点击，支持“悬停即显、移走即隐”  
- 按功能拆分为独立子页面，便于多人并行开发与后期微前端集成  
二、功能清单（Level 1 → 2 → 3）  

LEVEL 1  业务域地图页  /domain-map.html  
├─ 画布渲染  
│  ├─ 读取 /api/domain/list 返回节点与边  
│  ├─ 使用 Canvas/WebGL 力导向布局，支持缩放、拖拽  
│  └─ 节点悬停 300 ms 后右侧滑出抽屉（opacity=0 → 1，不抢占焦点）  
├─ 抽屉内容  
│  ├─ 域名称、描述、责任人、最近变更时间  
│  └─ 按钮【进入该域】（跳转 Level 2）  
├─ 头部工具栏  
│  ├─ 搜索框（实时模糊匹配域名称）  
│  ├─ 新建域（弹窗录入名称/描述/负责人）  
│  └─ 导入/导出（JSON/CSV）  
└─ 快捷键  
   ├─ Ctrl+N 新建域  
   └─ Ctrl+E 导出全部  

LEVEL 2  域功能模块页  /domain-workbench.html?domainId=xxx  
左侧 Tab 导航（每次仅展开一个模块，切换无刷新）  
① 模型地图（默认）  
   ├─ 仅展示当前域下的模型节点与关系边  
   ├─ 悬停抽屉：模型名称、描述、属性数、关系数  
   ├─ 点击节点 → 进入 Level 3（模型详情页）  
   ├─ 支持按名称/标签实时过滤  
   └─ 支持导出 PNG/SVG  
② 模型管理  
   ├─ 卡片列表（名称、描述、创建人、更新时间）  
   ├─ 卡片操作：编辑、删除、进入详情  
   ├─ 顶部【+新建模型】→ 侧滑表单：名称/描述/父模型/标签  
   ├─ 导入（JSON/Excel）→ 预览 → 确认写入  
   └─ 导出（支持勾选部分导出）  
③ 共享属性  
   ├─ 卡片列表（属性名、数据类型、描述、引用次数）  
   ├─ 新建：名称/类型/长度/精度/描述/值域  
   ├─ 编辑/删除（若已被模型引用，则提示“强制删除将影响 xx 个模型”）  
   ├─ 导入/导出  
   └─ 支持版本对比（修改前后 diff）  
④ 关系管理  
   ├─ 卡片列表（关系名、源→目标、类型、描述）  
   ├─ 新建：选择源类型、目标类型、关系类型（part-of/refers-to 等）  
   ├─ 编辑/删除/启用禁用  
   ├─ 导入/导出  
   └─ 支持“关系模板”快速复用  
⑤ 语义/指标  
   ├─ 卡片列表（名称、表达式、返回类型、状态）  
   ├─ 新建：名称/表达式（SPARQL 或 DSL）/描述/单位  
   ├─ 语法校验→实时返回示例值  
   ├─ 编辑/删除/发布下线  
   ├─ 导入/导出  
   └─ 支持“复制并创建”  

通用交互  
├─ 所有抽屉默认 320 px 宽，悬停出现 300 ms，移出消失 200 ms  
├─ 抽屉层级 z-index=50，不遮罩，不影响后续点击  
├─ 所有新增/编辑弹窗统一使用 `<sliding-panel>` 组件，占屏 60 %  
├─ 删除均需二次确认，并提示下游影响  
├─ 导入均先预览→确认→回显结果（成功/失败明细）  

LEVEL 3  模型详情页  /model-detail.html?modelId=xxx  
顶部面包屑：业务域 > 模型名称  
Tab 切换（锚点记录，刷新保持）  
① 属性  
   ├─ 卡片列表（名称、类型、是否必填、描述）  
   ├─ 新建/编辑/删除/批量导入/导出  
   ├─ 支持从“共享属性”快速引用（一键带入）  
   ├─ 支持拖拽排序  
   └─ 支持版本快照（修改后自动生成 v1→v2…）  
② 关系  
   ├─ 卡片列表（关系名、目标模型、类型、描述）  
   ├─ 新建：先选“目标模型”→再选“关系类型”→填写描述  
   ├─ 编辑/删除  
   ├─ 支持批量绑定（一次选多个目标模型）  
   └─ 导入/导出  
③ 数据源  
   ├─ 卡片列表（数据源名称、类型、URL、状态）  
   ├─ 查询：支持 MySQL、Oracle、Kafka、API 等类型  
   ├─ 绑定/解绑  
   ├─ 测试连接（实时返回连通结果）  
   └─ 导入/导出（仅配置，不含密码）  
④ 数据  
   ├─ 卡片列表（实例 ID、显示字段、创建时间）  
   ├─ 新建：表单录入 / JSON 粘贴 / Excel 上传  
   ├─ 编辑/删除/批量删除  
   ├─ 导入（支持冲突策略：跳过/覆盖/提示）  
   └─ 导出（勾选导出，支持分页全选）  
⑤ 语义/指标  
   ├─ 已挂接指标卡片（名称、表达式、最近值）  
   ├─ 支持“从域公共指标池引用”  
   ├─ 支持快速新建（侧滑表单同 Level 2）  
   ├─ 支持运行一次→回显结果  
   └─ 支持导出指标结果 CSV  

------------------------------------------------
三、非功能需求  

1. 性能  
   - 业务域地图首屏 < 1 s，节点 5 k 以内拖拽帧率 > 50 fps  
   - 任何导入接口 1 w 条记录 < 5 s 返回结果  

2. 安全  
   - 所有写操作走 JWT 鉴权，返回 403 若 token 失效  
   - 导入文件服务端先杀毒+大小限制 10 MB  

3. 兼容性  
   - Chrome ≥ 80、Edge ≥ 80、Firefox ≥ 75  
   - 1920 * 1080 与 1366 * 768 自适应  

4. 日志与审计  
   - 前端抛出 window.error 自动上报 /logs/fe  
   - 后端记录 who/when/what，保留 180 天  

------------------------------------------------
四、页面拆分目录（物理文件）  

/domain-map.html           – 业务域地图首页  
/domain-workbench.html     – 域功能模块容器页  
  ├─ inc/model-map.html    – 模型地图子页面（被 iframe/div 动态加载）  
  ├─ inc/model-mgr.html  
  ├─ inc/shared-attr.html  
  ├─ inc/relation-mgr.html  
  ├─ inc/semantic-indi.html  
/model-detail.html         – 模型详情容器页  
  ├─ inc/tab-attr.html  
  ├─ inc/tab-relation.html  
  ├─ inc/tab-datasource.html  
  ├─ inc/tab-data.html  
  ├─ inc/tab-semantic.html  

（注：inc 目录为纯片段，可用 iframe 或 fetch+template 方式嵌入，方便后期迁移到 React/Vue 路由）  

------------------------------------------------
五、接口约定（REST 风格）  

GET    /api/domain/list                                    – 域列表+边  
POST   /api/domain                                        – 新建域  
PUT    /api/domain/{id}                                   – 更新域  
DELETE /api/domain/{id}                                   – 删除域（级联提示）  
POST   /api/domain/import                                 – 批量导入域  
GET    /api/domain/export?ids=1,2,3                       – 导出  

GET    /api/model?domainId=xxx                            – 某域下模型  
POST   /api/model                                         – 新建模型  
……（其余模型、属性、关系、指标接口均按同规范生成，略）  

------------------------------------------------
六、交付节奏  

MVP（3 周）  
  - Level 1 业务域地图 + 新建/导入/导出  
  - Level 2 模型地图 + 模型管理完整 CRUD  
  - 抽屉悬停 & 不遮挡交互  

V2（+3 周）  
  - 共享属性、关系管理、语义/指标 全功能  
  - Level 3 属性/关系/数据源 完整功能  

V3（+2 周）  
  - Level 3 数据模块、语义/指标运行与结果导出  
  - 权限、审计、性能压测、文档补齐  

------------------------------------------------
七、测试用例（节选）  

TC-01  悬停抽屉  
  步骤：鼠标移入业务域节点 A，等待 300 ms  
  期望：右侧抽屉滑出，显示 A 名称与描述；移出节点 200 ms 抽屉消失  

TC-02  新建模型  
  步骤：在模型管理点击“+新建”→ 输入名称 B → 保存  
  期望：列表出现 B 卡片；再进入模型地图可见 B 节点；数据库存在记录  

TC-03  导入共享属性  
  步骤：选择 Excel（含 2 条合法 1 条重复）→ 上传 → 预览  
  期望：提示“2 成功 1 重复”；确认后列表新增 2 条；重复行被跳过  

TC-04  抽屉不遮挡  
  步骤：悬停出现抽屉后，直接点击页面“新建”按钮  
  期望：抽屉自动消失，新建弹窗正常弹出，无遮罩层  

------------------------------------------------